<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EconoLearn â€” CUET PG Economics</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React + Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <link rel="icon" type="image/png" href="./favicon-32.png" />
  <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
  <link rel="manifest" href="./manifest.webmanifest" />

  <!-- ===== THEME INITIALIZER (Light / Dark / Deep / System) ===== -->
  <script>
    (function() {
      const key = 'econ_theme';
      const html = document.documentElement;
      const stored = localStorage.getItem(key) || 'system';

      function isDarkLike(mode) {
        return mode === 'dark' || mode === 'deep' ||
          (mode === 'system' && window.matchMedia('(prefers-color-scheme: dark)').matches);
      }

      function apply(mode) {
        html.classList.toggle('deep', mode === 'deep');
        html.classList.toggle('dark', isDarkLike(mode));
        window.dispatchEvent(new CustomEvent('econ-theme-change', { detail: { mode } }));
      }

      window.__econTheme = {
        get: () => localStorage.getItem(key) || 'system',
        set: (mode) => { localStorage.setItem(key, mode); apply(mode); },
        cycle: () => {
          const order = ['dark', 'deep', 'light', 'system'];
          const cur = localStorage.getItem(key) || 'system';
          const next = order[(order.indexOf(cur) + 1) % order.length];
          localStorage.setItem(key, next);
          apply(next);
          return next;
        }
      };

      apply(stored);

      // Auto adjust if system theme changes
      try {
        const mq = window.matchMedia('(prefers-color-scheme: dark)');
        mq.addEventListener('change', () => {
          if ((localStorage.getItem(key) || 'system') === 'system') apply('system');
        });
      } catch {}
    })();
  </script>

  <!-- ===== DEEP DARK THEME OVERLAY ===== -->
  <style>
    html.dark.deep { background-color: #05070d; }
    html.dark.deep body {
      background:
        radial-gradient(1200px 800px at 50% -10%, rgba(255,255,255,.05), transparent 55%),
        radial-gradient(800px 600px at 120% -20%, rgba(56,189,248,.06), transparent 50%),
        #0b1220;
      background-attachment: fixed, fixed, fixed;
    }
    html.dark.deep [class*="bg-white/60"],
    html.dark.deep [class*="bg-white/70"],
    html.dark.deep [class*="bg-white/95"] { background-color: rgba(2,6,23,.85) !important; }
    html.dark.deep [class*="border-white/50"],
    html.dark.deep [class*="border-white/60"] { border-color: rgba(255,255,255,.06) !important; }
    html.dark.deep .backdrop-blur,
    html.dark.deep [class*="backdrop-blur"] { background-color: rgba(2,6,23,.70) !important; }
    html.dark.deep .hover\:bg-white:hover { background-color: rgba(255,255,255,.06) !important; }
  </style>
</head>

<body class="bg-rose-50 dark:bg-slate-900 text-gray-800 dark:text-gray-100 transition-colors duration-500 min-h-screen">
  <div id="root"></div>

  <!-- ===== Floating Theme FAB (Bottom-right) ===== -->
  <button
    id="theme-fab"
    type="button"
    class="fixed z-40 bottom-5 right-5 px-3.5 py-2 rounded-full shadow-lg
           bg-white/70 dark:bg-slate-800/70 backdrop-blur border border-white/50
           text-slate-700 dark:text-slate-100 hover:shadow-xl hover:-translate-y-0.5
           transition flex items-center gap-2"
    aria-label="Toggle Theme"
  >
    <span id="theme-fab-icon">ðŸŒ—</span>
    <span id="theme-fab-label" class="text-sm font-medium">Theme</span>
  </button>

  <script>
    // Handle floating button updates
    (function(){
      const btn = document.getElementById('theme-fab');
      const label = document.getElementById('theme-fab-label');

      function prettify(mode) {
        return mode === 'dark' ? 'Dark'
             : mode === 'deep' ? 'Deep'
             : mode === 'light' ? 'Light'
             : 'System';
      }

      function updateLabel(mode) {
        label.textContent = prettify(mode);
      }

      updateLabel(window.__econTheme.get());
      btn.addEventListener('click', () => updateLabel(window.__econTheme.cycle()));
      window.addEventListener('econ-theme-change', (e) => updateLabel(e.detail.mode));
    })();
  </script>

  <!-- Main React App -->
  <script type="text/babel" src="./main.jsx?v=11"></script>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js?v=11');
      });
    }
  </script>
</body>
</html>